<html>

<head>
    <title>Calculateur de dépenses mensuelles</title>
    <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'IBM Plex Sans', sans-serif;
            background-color: #f7f7f7;
            margin: 0;
            padding: 0;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            position: relative;
            top: 50px;
            text-align: center;
        }
        
        h1 {
            margin-top: 0;
        }
        
        table {
            margin: 20px auto;
            border-collapse: collapse;
            width: 100%;
        }
        
        table th,
        table td {
            border: 1px solid #ccc;
            border: 1px solid black;
            padding: 10px;
        }
        
        table th {
            background-color: ##4CAF50;
            border: 1px solid black;
        }
        
        .button {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 12px 24px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 5px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }
        
        .export {
            background-color: #008CBA;
        }
        
        .file-input {
            display: none;
        }
        
        .file-input+label {
            background-color: #008CBA;
            color: white;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 5px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            font-family: 'IBM Plex Sans', sans-serif;
        }
        
        .file-input+label:hover {
            background-color: #006B8F;
        }
    </style>
</head>

<body>
    <div class="container">


        <table id="depenses">
            <thead>
                <tr>
                    <th class="texttab">Dépense</th>
                    <th class="texttab">Montant</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" name="depense1"></td>
                    <td><input type="number" name="montant1" min="0"></td>
                </tr>
                <tr>
                    <td><input type="text" name="depense2"></td>
                    <td><input type="number" name="montant2" min="0"></td>
                </tr>

                <tr>
                    <td><input type="text" name="depense3"></td>
                    <td><input type="number" name="montant3" min="0"></td>
                </tr>
                <tr>
                    <td><input type="text" name="depense4"></td>
                    <td><input type="number" name="montant4" min="0"></td>
                </tr>
                <tr>
                    <td><input type="text" name="depense5"></td>
                    <td><input type="number" name="montant5" min="0"></td>
                </tr>

                <tr>
                    <td><input type="text" name="depense6"></td>
                    <td><input type="number" name="montant6" min="0"></td>
                </tr>

                <tr>
                    <td><input type="text" name="depense7"></td>
                    <td><input type="number" name="montant7" min="0"></td>
                </tr>

                <tr>
                    <td><input type="text" name="depense8"></td>
                    <td><input type="number" name="montant8" min="0"></td>
                </tr>

                <tr>
                    <td><input type="text" name="depense9"></td>
                    <td><input type="number" name="montant9" min="0"></td>
                </tr>

                <tr>
                    <td><input type="text" name="depense10"></td>
                    <td><input type="number" name="montant10" min="0"></td>
                </tr>

                <tr>
                    <td><input type="text" name="depense11"></td>
                    <td><input type="number" name="montant11" min="0"></td>
                </tr>

                <tr>
                    <td><input type="text" name="depense12"></td>
                    <td><input type="number" name="montant12" min="0"></td>
                </tr>

                <tr>
                    <td><input type="text" name="depense13"></td>
                    <td><input type="number" name="montant13" min="0"></td>
                </tr>

                <tr>
                    <td><input type="text" name="depense14"></td>
                    <td><input type="number" name="montant14" min="0"></td>
                </tr>

                <tr>
                    <td><input type="text" name="depense15"></td>
                    <td><input type="number" name="montant15" min="0"></td>
                </tr>

            </tbody>
        </table>

        <div>
            <label for="salaire">Salaire mensuel:</label>
            <input type="number" name="salaire" min="0" id="salaire">
        </div>

        <br>

        <div id="resultat"></div>

        <div>
            <button class="button export" onclick="exporter()">Exporter en CSV</button>
            <input type="file" id="importer" class="file-input" accept=".csv">
            <label for="importer">Importer depuis CSV</label>
        </div>
    </div>

    <script>
        function calculer() {
            let depenses = document.querySelectorAll('#depenses tbody tr');
            let total = 0;

            for (let i = 0; i < depenses.length; i++) {
                let montant = depenses[i].querySelector('input[name^="montant"]').value;
                if (montant) {
                    total += parseFloat(montant);
                }
            }

            let salaire = document.querySelector('#salaire').value;
            if (salaire) {
                total = parseFloat(salaire) - total;
            }

            let charges = total.toFixed(2);
            let restant = document.querySelector('#salaire').value - charges;

            let resultat = document.querySelector('#resultat');
            resultat.innerHTML = '';
            resultat.appendChild(document.createTextNode('Restant après charges:' + charges + '\n'));
            resultat.appendChild(document.createTextNode('Total des dépenses:' + restant.toFixed(2)));
        }

        function exporter() {
            let csv = 'Dépense,Montant\n';
            let depenses = document.querySelectorAll('#depenses tbody tr');
            let total = 0;

            for (let i = 0; i < depenses.length; i++) {
                let depense = depenses[i].querySelector('input[name^="depense"]').value;
                let montant = depenses[i].querySelector('input[name^="montant"]').value;
                if (depense && montant) {
                    csv += depense + ',' + montant + '\n';
                    total += parseFloat(montant);
                }
            }

            let salaire = document.querySelector('#salaire').value;
            if (salaire) {
                csv += 'Salaire,' + salaire + '\n';
            }

            let charges = total.toFixed(2);
            csv += 'Total des dépenses,' + charges + '\n';

            let restant = salaire - charges;
            csv += 'Restant après charges,' + restant.toFixed(2) + '\n';

            let a = document.createElement('a');
            a.href = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);
            a.download = 'depenses.csv';
            a.click();
        }
        document.querySelector('#importer').addEventListener('change', importer);

        function importer() {
            let input = document.querySelector('#importer');
            let file = input.files[0];
            let reader = new FileReader();

            reader.onload = function(event) {
                let csv = event.target.result;
                let lines = csv.split('\n').slice(1); // ignore the first line
                let depenses = document.querySelectorAll('#depenses tbody tr');
                let ignoredTerms = ["Salaire", "Total des dépenses", "Restant après charges"];

                for (let i = 0; i < depenses.length; i++) {
                    let line = lines[i];
                    if (line) {
                        let columns = line.split(',');
                        let depense = columns[0];
                        let montant = columns[1];

                        // check if line contains any ignored term
                        let ignoreLine = false;
                        ignoredTerms.forEach(term => {
                            if (line.includes(term)) {
                                ignoreLine = true;
                            }
                        });

                        // import line only if it doesn't contain any ignored term
                        if (!ignoreLine) {
                            depenses[i].querySelector('input[name^="depense"]').value = depense;
                            depenses[i].querySelector('input[name^="montant"]').value = montant;
                        }
                    }
                }
            };

            reader.readAsText(file);
        }

        let inputs = document.querySelectorAll('#depenses input[type="number"], #salaire');
        for (let i = 0; i < inputs.length; i++) {
            inputs[i].addEventListener('input', calculer);
        }
    </script>
    <style>
        body {
            font-family: 'IBM Plex Sans', sans-serif;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
        }
        
        th,
        td {
            text-align: left;
            padding: 8px;
        }
        
        th {
            background-color: lightgray;
            color: black;
        }
        
        tr:nth-child(even) {
            background-color: lightblue;
        }
        
        input[type="text"],
        input[type="number"] {
            width: 100%;
            padding: 6px;
            border: 1px solid black;
            background-color: #f2f2f2;
            box-sizing: border-box;
        }
        
        label {
            display: block;
            margin-bottom: 4px;
        }
        
        .button {
            background-color: #004C9A;
            color: white;
            padding: 12px 24px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin-top: 16px;
            border-radius: 8px;
            font-family: 'IBM Plex Sans', sans-serif;
        }
        
        .button.export {
            background-color: purple;
            margin-right: 8px;
        }
        
        .file-input {
            display: none;
        }
        
        label[for="importer"] {
            background-color: #004C9A;
            color: white;
            padding: 12px 24px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin-top: 16px;
            border-radius: 8px;
            display: inline-block;
        }
    </style>
</body>

</html>